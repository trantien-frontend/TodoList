class Employee{constructor(e,t,o,l,a){this.id=e,this.name=t,this.email=o,this.address=l,this.phone=a}}function validator(){this.isRequire=function(e){return!!e.trim()||"Vui lòng Nhập Trường này"},this.isEmail=function(e){return!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)||"Trường này phải là Email"},this.isPhone=function(e){return!!e.match(/^\d{10}$/)||"Trường này phải là số điện thoại"}}class optionSort{sortAz(e){return e.sort((e,t)=>{e=e.name.toLowerCase(),t=t.name.toLowerCase();return e<t?-1:t<e?1:0}),e}sortZa(e){return e.sort((e,t)=>{e=e.name.toLowerCase(),t=t.name.toLowerCase();return e<t?-1:t<e?1:0}),e.reverse(),e}}const validate=new validator,buttonShowForm=document.querySelector("#show-form"),buttonsHideForm=document.querySelectorAll(".hide-form"),buttonShowFormDel=document.querySelector("#del-form-checked"),buttonAddEmployee=document.querySelector("#add-employee"),buttonDelEmployee=document.querySelector("#del-employee"),buttonEditEmployee=document.querySelector("#edit-employee"),form=document.querySelector(".main-form"),overlay=document.querySelector(".overlay"),inputFullName=document.querySelector("#fullname"),inputEmail=document.querySelector("#email"),inputAdress=document.querySelector("#address"),inputPhone=document.querySelector("#phone"),inputs=document.querySelectorAll(".form-control"),buttonAllCheck=document.querySelector(".allcheck");let deleteEmployees="";for(const u of buttonsHideForm)u.onclick=()=>{hideForm()};const hideForm=()=>{form.className="main-form",overlay.classList.remove("overlay-show")},resetForm=()=>{inputFullName.value="",inputEmail.value="",inputAdress.value="",inputPhone.value=""},validateForm=e=>{let t=0;var o=e.getAttribute("id");let l=e.parentElement,a=l.querySelector(".form-error"),r=validate.isRequire(e.value);return"email"===o&&(r=validate.isEmail(e.value)),"phone"===o&&(r=validate.isPhone(e.value)),!0===r?(e.classList.remove("invalid"),a.innerHTML=""):(e.classList.add("invalid"),a.innerHTML=r,t++),t};for(const input of inputs)input.onblur=()=>{validateForm(input)},input.onkeyup=()=>{validateForm(input)};const pushEmployee=()=>{let e=JSON.parse(localStorage.getItem("Employees"));null===e&&(e=[]);var t=new Employee(e.length,inputFullName.value,inputEmail.value,inputAdress.value,inputPhone.value);e.push(t),localStorage.setItem("Employees",JSON.stringify(e))},getEmployees=()=>{return JSON.parse(localStorage.getItem("Employees"))},setEmployees=e=>{localStorage.setItem("Employees",JSON.stringify(e))},setCurrentPages=e=>{localStorage.setItem("CurrentPage",JSON.stringify(e))},getCurrentPage=()=>localStorage.getItem("CurrentPage")?JSON.parse(localStorage.getItem("currentPage")):1,setStatusSort=e=>{localStorage.setItem("StatusSort",JSON.stringify(e))},getStatusSort=()=>localStorage.getItem("StatusSort")?JSON.parse(localStorage.getItem("StatusSort")):"name-asc",renderEmployees=e=>{let t=document.querySelector("tbody");t.innerHTML="";for(const l of e){let e=document.createElement("tr");var o=`
    <tr class="body-table">
      <td>
        <input type='checkbox' class="checkbox" value="${l.id}"/>
      </td>
      <td data-label="${Object.keys(l)[1]}">
        ${l.name}
      </td>
      <td data-label="${Object.keys(l)[2]}">
        ${l.email}
      </td>
      <td data-label="${Object.keys(l)[3]}">
        ${l.address}
      </td>
      <td data-label="${Object.keys(l)[4]}">
        ${l.phone}
      </td>
      <td data-label="action">
        <i class="fas fa-edit" data-id=${l.id} id="edit-form"></i>
        <i class="fas fa-trash-alt" data-id=${l.id} id="del-form"></i>
      </td>
    </tr>
    `;e.innerHTML=o,t.appendChild(e)}showFormEdit(),showFormDel(),eventDelEmployee(),hideForm(),resetForm()},showFormEdit=()=>{for(const l of document.querySelectorAll("#edit-form"))l.onclick=()=>{form.classList.add("main-form__edit"),overlay.classList.add("overlay-show");const t=Number.parseInt(l.dataset.id),e=getEmployees();var o=e.find(e=>e.id==t);inputFullName.value=o.name,inputEmail.value=o.email,inputAdress.value=o.address,inputPhone.value=o.phone,editEmployee(t)}},showFormDel=()=>{for(const t of document.querySelectorAll("#del-form"))t.onclick=()=>{deleteEmployees="deleteEmployee",form.classList.add("main-form__del"),overlay.classList.add("overlay-show");var e=t.dataset.id;eventDelEmployee(e)}};buttonShowForm.onclick=()=>{form.classList.add("main-form__add"),overlay.classList.add("overlay-show")},buttonAddEmployee.onclick=()=>{let e;for(input of inputs)e=validateForm(input);if(0==e){pushEmployee();const t=[...getEmployees()];let e=document.querySelector(".loading");e.classList.remove("loading--hide"),setTimeout(()=>{pagination(t),e.classList.add("loading--hide")},1e3)}};const editEmployee=r=>{buttonEditEmployee.onclick=()=>{let e;for(input of inputs)e=validateForm(input);if(0==e){var t=getEmployees(),o=new Employee(r,inputFullName.value,inputEmail.value,inputAdress.value,inputPhone.value);for(const a of t)a.id===r&&(a.name=o.name,a.email=o.email,a.address=o.address,a.phone=o.phone);const l=[...t];setEmployees(l);let e=document.querySelector(".loading");e.classList.remove("loading--hide"),setTimeout(()=>{pagination(l),e.classList.add("loading--hide")},1e3)}}},delEmployee=t=>{const e=getEmployees();var o=e.filter(e=>e.id!=t);setEmployees(o),pagination(o)},delEmployees=()=>{const e=[...document.querySelectorAll(".checkbox")],o=getEmployees(),t=e.filter(e=>!0===e.checked);for(const a of t.map(e=>e.value))o.forEach((e,t)=>{e.id==a&&o.splice(t,1)});var l=[...o];setEmployees(l),eventDelEmployee(),pagination(l)},eventDelEmployee=t=>{buttonDelEmployee.onclick=()=>{let e=document.querySelector(".loading");e.classList.remove("loading--hide"),setTimeout(()=>{"deleteEmployees"===deleteEmployees&&(delEmployees(),e.classList.add("loading--hide")),"deleteEmployee"===deleteEmployees&&(delEmployee(t),e.classList.add("loading--hide"))},1500)}};buttonAllCheck.onclick=e=>{var t=e.target.checked,e=[...document.querySelectorAll(".checkbox")];if(0!==e.length)for(const o of e)o.checked=t},buttonShowFormDel.onclick=()=>{const e=[...document.querySelectorAll(".checkbox")];!0===e.some(e=>!0===e.checked)&&(form.classList.add("main-form__del"),overlay.classList.add("overlay-show"),deleteEmployees="deleteEmployees")};const loadingPage=()=>{let e=document.querySelector(".loading");console.log(e),setTimeout(()=>{e.classList.add("loading--hide")},3e3)};let currentPage=getCurrentPage(),start=0;const _limit=5;let end=_limit;const handelButtonPagination=o=>{let l=document.querySelectorAll(".numbersPage__button");l.forEach(t=>{t.addEventListener("click",()=>{for(const t of l)t.classList.remove("numbersPage--active");t.classList.add("numbersPage--active");var e=parseInt(t.dataset.current);currentPage=e,pagination(o)})})},createButtonPagination=e=>{var t=e.length,o=Math.ceil(t/_limit);let l=document.querySelector(".numbersPage");console.log(o),l.innerHTML="";for(let t=0;t<o;t++){let e=document.createElement("li");e.setAttribute("class","numbersPage__button"),e.setAttribute("data-current",t+1),e.innerHTML=t+1,t==currentPage-1&&e.classList.add("numbersPage--active"),l.appendChild(e)}handelButtonPagination(e)},pagination=e=>{if(null!==e){start=(currentPage-1)*_limit,end=currentPage*_limit,createButtonPagination(e);const t=[...e];e=t.slice(start,end);renderEmployees(e)}},formSearch=document.querySelector(".form-search"),inputSearch=document.querySelector(".search");inputSearch.oninput=e=>{var t=e.target.value,e=getEmployees();""===t&&pagination(e)},formSearch.onsubmit=e=>{e.preventDefault();const t=getEmployees();if(null!==t){const o=inputSearch.value;""!==o?(e=t.filter(e=>o===e.name||o===e.email||o===e.phone||o===e.address),pagination(e)):pagination(t)}};const sort=document.querySelector("#sort");sort.onchange=e=>{var t=getEmployees(),e=e.target.value;setStatusSort(e),sortName(t,e)};const sortName=(e,t)=>{e=[...e];let o;const l=new optionSort;"name-asc"===t&&(o=l.sortAz(e)),"name-desc"===t&&(o=l.sortZa(e)),pagination(o)},defaultSortName=()=>{var e=[...document.querySelectorAll("#sort option")],t=getStatusSort(),o=getEmployees();for(const l of e)l.value===t&&l.setAttribute("selected","selected");sortName(o,t)},defaultLoadingPage=()=>{loadingPage(),null!==getEmployees()&&defaultSortName()};defaultLoadingPage();