"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Employee=function e(t,n,o,r,a){_classCallCheck(this,e),this.id=t,this.name=n,this.email=o,this.address=r,this.phone=a};function validator(){this.isRequire=function(e){return!!e.trim()||"Vui lòng Nhập Trường này"},this.isEmail=function(e){return!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)||"Trường này phải là Email"},this.isPhone=function(e){return!!e.match(/^\d{10}$/)||"Trường này phải là số điện thoại"}}var optionSort=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"sortAz",value:function(e){return e.sort(function(e,t){e=e.name.toLowerCase(),t=t.name.toLowerCase();return e<t?-1:t<e?1:0}),e}},{key:"sortZa",value:function(e){return e.sort(function(e,t){e=e.name.toLowerCase(),t=t.name.toLowerCase();return e<t?-1:t<e?1:0}),e.reverse(),e}}]),e}(),validate=new validator,start=0,ROWS=5,currentPage=getCurrentPage(),end=ROWS,inputSearch=document.querySelector(".search"),select=document.querySelector("#sort"),btnAllCheck=document.querySelector(".allcheck"),btnShowFormDel=document.querySelector("#del-form-checked"),btnShowFormAdd=document.querySelector("#show-form"),btnsHideForm=document.querySelectorAll(".hide-form"),inputs=_toConsumableArray(document.querySelectorAll(".form-control")),inputFullName=document.querySelector("#fullname"),inputEmail=document.querySelector("#email"),inputAdress=document.querySelector("#address"),inputPhone=document.querySelector("#phone");function loadingShow(){document.querySelector(".loading").classList.add("loading--show")}function loadingHide(){document.querySelector(".loading").classList.remove("loading--show")}function eventShowFormDel(){document.querySelectorAll("#del-form").forEach(function(e){e.addEventListener("click",function(){deleteEmployee(e.dataset.id,"del"),showFormDel()})})}function check(){var e=_toConsumableArray(document.querySelectorAll(".checkbox"));1==this.checked?e.forEach(function(e){e.checked=!0}):e.forEach(function(e){e.checked=!1})}function showFormAdd(){document.querySelector(".main-form").classList.add("main-form__add"),showOverlay(),createEmployee(),resetForm()}function showFormDel(){document.querySelector(".main-form").classList.add("main-form__del"),showOverlay()}function showFormEdit(){var e=document.querySelectorAll("#edit-form"),n=document.querySelector(".main-form"),o=getEmployFromStorgae();e.forEach(function(e){e.addEventListener("click",function(){var t=e.dataset.id;n.classList.add("main-form__edit"),o.forEach(function(e){e.id==t&&(inputFullName.value=e.name,inputEmail.value=e.email,inputAdress.value=e.address,inputPhone.value=e.phone)}),editEmployee(t),showOverlay()})})}function hideForm(){document.querySelector(".main-form").className="main-form",hideOverlay(),resetForm()}function resetForm(){inputFullName.value="",inputEmail.value="",inputAdress.value="",inputPhone.value="",document.querySelectorAll(".form-error").forEach(function(e){e.innerText=""}),inputs.forEach(function(e){e.classList.remove("invalid")})}function showOverlay(){document.querySelector(".overlay").classList.add("overlay-show")}function hideOverlay(){document.querySelector(".overlay").classList.remove("overlay-show")}function createEmployee(){var e=document.querySelector("#add-employee"),n=document.querySelectorAll(".form-control");e.addEventListener("click",function(){var t=0;n.forEach(function(e){t=validateForm(e,e.value)}),0!=t||(pushEmployToStorage(),sortDefault(),showFormEdit(),eventShowFormDel(),hideForm())})}function editEmployee(o){var r=document.querySelectorAll(".form-control");document.querySelector("#edit-employee").addEventListener("click",function(){var n,e,t=0;r.forEach(function(e){t=validateForm(e,e.value)}),0!=t||(n=new Employee(o,inputFullName.value,inputEmail.value,inputAdress.value,inputPhone.value),(e=getEmployFromStorgae()).forEach(function(e,t){e.id==o&&(e.name=n.name,e.email=n.email,e.phone=n.phone,e.address=n.address)}),loadingShow(),setTimeout(function(){setEmployStorage(e),hideForm(),pagination(),showFormEdit(),eventShowFormDel(),loadingHide()},1e3))})}function deleteEmployee(n,e){document.querySelector("#del-employee").addEventListener("click",function(){var o=getEmployFromStorgae();"del"==e&&o.forEach(function(e,t){e.id==n&&o.splice(t,1)}),"dels"==e&&n.forEach(function(n){o.forEach(function(e,t){e.id==n.value&&o.splice(t,1)})}),loadingShow(),setTimeout(function(){btnAllCheck.checked=!1,setEmployStorage(o),pagination(),hideForm(),eventShowFormDel(),showFormEdit(),loadingHide()},1e3)})}function validateForm(e,t){var n=0,o=e.parentElement.querySelector(".form-error"),r=e.getAttribute("name"),a=validate.isRequire(t);return"email"==r&&(a=validate.isEmail(t)),"phone"==r&&(a=validate.isPhone(t)),!0===a?(o.innerText="",e.classList.remove("invalid")):(o.innerText=a,e.classList.add("invalid"),n++),n}function renderEmployee(e){var n=document.querySelector("tbody");n.innerHTML="",e.forEach(function(e){var t=document.createElement("tr"),e='\n    <tr class="body-table">\n      <td>\n        <input type=\'checkbox\' class="checkbox" value="'.concat(e.id,'"/>\n      </td>\n      <td data-label="').concat(Object.keys(e)[1],'">\n        ').concat(e.name,'\n      </td>\n      <td data-label="').concat(Object.keys(e)[2],'">\n        ').concat(e.email,'\n      </td>\n      <td data-label="').concat(Object.keys(e)[3],'">\n        ').concat(e.address,'\n      </td>\n      <td data-label="').concat(Object.keys(e)[4],'">\n        ').concat(e.phone,'\n      </td>\n      <td data-label="action">\n        <i class="fas fa-edit" data-id=').concat(e.id,' id="edit-form"></i>\n        <i class="fas fa-trash-alt" data-id=').concat(e.id,' id="del-form"></i>\n      </td>\n    </tr>\n    ');t.innerHTML=e,n.appendChild(t)})}function pagination(){var e=getEmployFromStorgae();null!==e&&(0<=e.length&&createBtnPagination(e),start=(currentPage-1)*ROWS,end=currentPage*ROWS,e=e.slice(start,end),console.log(e),renderEmployee(e))}function createBtnPagination(e){var e=e.length,t=Math.ceil(e/ROWS),n=document.querySelector(".numbersPage");n.innerHTML="";for(var o=0;o<t;o++){var r=document.createElement("li");r.setAttribute("class","numbersPage__button"),r.innerHTML=o+1,o==currentPage-1&&r.classList.add("numbersPage--active"),n.appendChild(r)}numberPageClick()}function numberPageClick(){var n=document.querySelectorAll(".numbersPage__button");n.forEach(function(e,t){e.addEventListener("click",function(){n.forEach(function(e){e.classList.remove("numbersPage--active")}),setCurrentPage(currentPage=t+1),pagination(),eventShowFormDel(),showFormEdit()})})}function search(){var e=getEmployFromStorgae(),n=this.value,o=[];e.forEach(function(e){var t=e.name;e.email,e.address,e.phone;t.includes(n)&&(o.push(e),renderEmployee(o)),""==n&&(pagination(),showFormEdit(),eventShowFormDel())})}function sortEmployees(e){var t,n=new optionSort,o=getEmployFromStorgae();null!=o&&0<=o.length&&("name-descending"==e&&(t=n.sortAz(o)),"name-ascending"==e&&(t=n.sortZa(o)),setStatusSort(e),setEmployStorage(t),pagination())}function sortDefault(){var t=getStatusSort();document.querySelectorAll("#sort option").forEach(function(e){e.value==t&&e.setAttribute("selected","selected")}),sortEmployees(t)}function pushEmployToStorage(){var e=JSON.parse(localStorage.getItem("employees"));null===e&&(e=[]);var t=new Employee(e.length+1,inputFullName.value,inputEmail.value,inputAdress.value,inputPhone.value);console.log(e),console.log(t),e.push(t),localStorage.setItem("employees",JSON.stringify(e))}function getEmployFromStorgae(){return localStorage.getItem("employees")?JSON.parse(localStorage.getItem("employees")):[]}function setEmployStorage(e){localStorage.setItem("employees",JSON.stringify(e))}function setStatusSort(e){localStorage.setItem("statusSort",JSON.stringify(e))}function getStatusSort(){return localStorage.getItem("statusSort")?JSON.parse(localStorage.getItem("statusSort")):"name-descending"}function setCurrentPage(e){localStorage.setItem("currentPage",JSON.stringify(e))}function getCurrentPage(){return localStorage.getItem("currentPage")?JSON.parse(localStorage.getItem("currentPage")):"1"}function setting(){sortDefault(),eventShowFormDel(),showFormEdit()}btnShowFormDel.addEventListener("click",function(){var t=0,n=[];document.querySelectorAll(".checkbox").forEach(function(e){1==e.checked&&(t++,n.push(e))}),0!=t&&(showFormDel(),deleteEmployee(n,"dels"))}),btnShowFormAdd.addEventListener("click",showFormAdd),btnsHideForm.forEach(function(e){e.addEventListener("click",hideForm)}),inputSearch.addEventListener("input",search),inputs.forEach(function(t){t.addEventListener("blur",function(){var e=t.value;validateForm(t,e)}),t.addEventListener("keyup",function(){var e=t.value;validateForm(t,e)})}),select.addEventListener("change",function(){sortEmployees(select.value)}),btnAllCheck.addEventListener("click",check),setting();